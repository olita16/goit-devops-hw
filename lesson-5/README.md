Terraform Infrastructure
Цей проєкт демонструє базову інфраструктуру AWS, розгорнуту за допомогою Terraform з використанням модульної архітектури.

##Структура проєкту

Основна директорія проекту: lesson-5/

Тут знаходяться головні файли Terraform та README.md.

main.tf – головний файл конфігурації Terraform, де підключаються всі модулі.
backend.tf – конфігурація віддаленого бекенду для зберігання стану Terraform у S3 та блокування через DynamoDB.
outputs.tf – файл, який виводить ключові дані про ресурси після застосування конфігурації.
README.md – документація проекту з описом структури, модулів та команд для роботи.

Директорія modules/ містить окремі модулі для інфраструктури:

s3-backend/ – модуль для налаштування S3 та DynamoDB для Terraform state:
s3.tf – створення S3-бакета.
dynamodb.tf – створення таблиці DynamoDB для блокування стану.
variables.tf – визначення змінних модуля.
outputs.tf – вивід інформації про створені ресурси (ім’я бакета та таблиці).
vpc/ – модуль для мережевої інфраструктури AWS:
vpc.tf – створення VPC, публічних та приватних підмереж, Internet Gateway.
routes.tf – налаштування таблиць маршрутизації для підмереж.
variables.tf – змінні для конфігурації VPC та підмереж.
outputs.tf – вивід ID VPC, підмереж та інших ресурсів.
ecr/ – модуль для контейнерного реєстру ECR:
ecr.tf – створення репозиторію ECR з політикою доступу та скануванням образів.
variables.tf – змінні для налаштування ECR (ім’я репозиторію, сканування на push).
outputs.tf – вивід URL, ARN та назви репозиторію.

        
Команди для роботи з проєктом

Ініціалізація Terraform
Перед початком роботи необхідно ініціалізувати Terraform та завантажити необхідні провайдери:

terraform init
Ця команда:

Завантажує провайдер AWS
Ініціалізує модулі
Підготовлює робоче середовище
Перегляд змін
Щоб подивитися, які зміни будуть застосовані до інфраструктури:

terraform plan
Ця команда показує план змін без їх застосування, що дозволяє перевірити конфігурацію перед розгортанням.

Застосування змін
Для створення або оновлення інфраструктури виконайте:

terraform apply
Terraform запитає підтвердження перед застосуванням змін.

Видалення інфраструктури
Для видалення всіх ресурсів, створених Terraform:

terraform destroy
Опис модулів
1. Модуль s3-backend
Призначення: Створення інфраструктури для віддаленого зберігання стану Terraform.

Що створює:

S3 бакет - для зберігання файлу стану Terraform (terraform.tfstate)
Увімкнено версіонування для збереження історії змін
Налаштовано контроль власності об'єктів
Шифрування даних
DynamoDB таблиця - для блокування стану під час одночасної роботи (state locking)
Режим оплати: "PAY_PER_REQUEST"
Hash key: "LockID"
Вхідні параметри:

bucket_name - назва S3 бакета
table_name - назва таблиці DynamoDB
Вивід:

s3_bucket_name - назва створеного S3 бакета
dynamodb_table_name - назва створеної таблиці DynamoDB
Навіщо потрібен: Цей модуль дозволяє зберігати стан Terraform у хмарі для збереження консинстенції архітектури

2. Модуль vpc
Призначення: Створення віртуальної приватної мережі (VPC) та мережевої інфраструктури в AWS.

Що створює:

VPC (Virtual Private Cloud) - ізольована мережа в AWS
Публічні підмережі (Public Subnets) - 3 підмережі в різних зонах доступності
Приватні підмережі (Private Subnets) - 3 підмережі в різних зонах доступності
Internet Gateway - шлюз для виходу в інтернет
Route Tables - таблиці маршрутизації для публічних підмереж

Вхідні параметри:

vpc_cidr_block - CIDR блок для VPC (наприклад, "10.0.0.0/16")
public_subnets - список CIDR блоків для публічних підмереж
private_subnets - список CIDR блоків для приватних підмереж
availability_zones - список зон доступності
vpc_name - ім'я VPC

Навіщо потрібен: VPC забезпечує ізоляцію мережі та контроль над трафіком:

Публічні підмережі - для веб-серверів, балансувальників навантаження
Приватні підмережі - для баз даних, бекенд-сервісів

3. Модуль ecr
Призначення: Створення репозиторію Amazon ECR (Elastic Container Registry) для зберігання Docker-образів.

Що створює:

ECR Repository - репозиторій для Docker-образів
Змінні теги образів (MUTABLE)
Автоматичне сканування на вразливості при завантаженні образів
Шифрування AES256
Repository Policy - політика доступу до репозиторію
Дозволи на pull та push образів
Перегляд та опис образів
Вхідні параметри:

ecr_name - назва репозиторію ECR
scan_on_push - увімкнути/вимкнути автоматичне сканування образів (true/false)
Вивід:

ecr_repository_url - URL репозиторію для push/pull образів
ecr_repository_arn - ARN репозиторію
ecr_repository_name - ім'я репозиторію
Навіщо потрібен: ECR - це приватний реєстр Docker-образів від AWS

Налаштування
У файлі backend.tf міститься закоментована конфігурація віддаленого бекенду. Після створення S3 бакета та DynamoDB таблиці за допомогою модуля s3-backend, розкоментуйте конфігурацію для використання віддаленого зберігання стану:

terraform {
  backend "s3" {
    bucket         = "terraform-state-bucket-goithw-rybak"
    key            = "lesson-5/terraform.tfstate"
    region         = "us-east-1"
    dynamodb_table = "terraform-locks"
    encrypt        = true
    profile        = "goithw"
  }
}

Після розкоментування виконайте:

terraform init -migrate-state

Вивід проєкту
Після успішного застосування конфігурації, Terraform виведе наступну інформацію:

s3_bucket_name - назва S3 бакета для зберігання стану
dynamodb_table_name - назва таблиці DynamoDB для блокувань
ecr_repository_url - URL для роботи з ECR репозиторієм
ecr_repository_arn - ARN ECR репозиторію
ecr_repository_name - ім'я ECR репозиторію

Додаткові команди:

Перегляд поточного стану
terraform show

Перегляд виходів
terraform output

Форматування коду
terraform fmt

Валідація конфігурації
terraform validate


